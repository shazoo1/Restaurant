@{
    ViewBag.Title = "Новый заказ";
}

    <div class="jumbotron">
        <h1>Новый заказ</h1>
    </div>
<div>
    <table style="width:100%" id="dishesTable">
        <tr>
            <th>Блюдо</th>
            <th>Цена</th>
            <th>Количество</th>
            <th>Стоимость</th>
        </tr>
    </table>
        <input type="button" data-toggle="collapse" data-target="#menu" value="Добавить"/>
        <ul id="menu" class="collapse"></ul>
</div>
<script>
    var unselected = @Html.Raw(Json.Encode(Model.Unselected));
    var selected = [];
    fillUnselectedList();
    function fillUnselectedList() {
        var menu = document.getElementById('menu');
        for (var i = 0; i < unselected.length; i++) {
            var dishName = unselected[i].Name;
            var dishPrice = unselected[i].Price;
            var dishId = unselected[i].Id;
            var row = $('<tr><td>' + dishName + '</td><td>' +
                dishPrice + '</td><td><input type="button" value="Добавить"' +
                'onclick="addToOrder(this.id, this)" id='+dishId+' /></td></tr>');
            $('#menu').append(row);
        }
    }
    function addToOrder(id, row) {
        row.closest('tr').remove();
        var selectedDishIndex = unselected.findIndex(x => x.Id === id);
        var selectedDish = unselected[selectedDishIndex];
        selected.push(selectedDish);
        var counter = '<input type=number min="0" step="1" onchange="countSum(this)">'
        var rowToAdd = '<tr><td>' + selectedDish.Name + '</td><td id="price">' +
            selectedDish.Price + '</td><td>' + counter + '</td><td id="sum">' +
            '</td></tr>';
        $('#dishesTable').append(rowToAdd);
        unselected.splice(selectedDishIndex,1);
    }
    function countSum(counter) {
        var tr = $(counter).parent().parent();
        var price = ($(tr).find('#price')).text();
        var sumCell = $(tr).find('#sum');
        sumCell.text(price * counter.value);
    }
    
</script>